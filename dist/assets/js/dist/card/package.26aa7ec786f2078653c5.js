webpackJsonp([4],{0:function(e,a,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}var n=t(3),r=o(n),d=t(21),c=o(d);t(1),t(39),Jsborya.ready(function(){window.app=null,app=new Vue({el:"#app",data:{off:{package:0,pre:0,deductionUsed:1},prestoreMoney:"",totalMoney:"",deductionMoney:"",payMoney:"",numberValue:"",packageInfo:{numberLevel:"1",sysOrderId:"000000000000000000",createTime:"00000",number:"0000000000",cityName:"--",numberValue:"0",packageMore:"0",deductionFee:"0",isNewVersion:"0",discountType:"2",package:[{title:"暂无套餐",code:"0",standard:"无",feeDescribe:"无",init:"0",selPackageMore:"0",prestoreMoneyList:[{prestoreMoney:"0",init:"0"}],prestoreDiscountList:{0:"10000"},selPackage:[{title:"暂无可选包",code:"0",standard:"无",feeDescribe:"无",init:"0"}]}]},prestoreMoneyList:[],selPackage:[],userInfo:{}},mounted:function(){this.initPage()},methods:{initPage:function(){var e=this,a=e.getUrlParam("type")||0;Jsborya.getUserInfo(function(t){if(e.userInfo=JSON.parse(BASE64.decode(t)),0==a)var o=e.getUrlParam("sysOrderId");else{var n=e.getUrlParam("packageCode"),r=e.getUrlParam("prestoreMoney"),o=e.getUrlParam("sysOrderId");if(2==a)var d=e.getUrlParam("bag")}e.getList({type:a,package:n||"",selPackage:d||"",prestoreMoney:r||"",sysOrderId:o},function(){Jsborya.webviewLoading({isLoad:!1})}),e.renderList()})},selectPackage:function(e){var a,t=this,o=e.target.name,n=e.target.parentNode.className;a="active"==n?["关闭"]:["选择","关闭"];var r=t.packageInfo.package[o];layer.open({content:'<div class="select-info"><dl><dt>套餐名称</dt><dd class="b">'+r.title+"</dd></dl><dl><dt>资费标准</dt><dd>"+r.standard+"</dd></dl><dl><dt>资费说明</dt><dd>"+r.feeDescribe+"</dd></dl></div>",btn:a,type:1,style:"width:90%;max-width:540px;top:-30px;",yes:function(){""==n&&(t.off.package=o,t.siblingC(e.target),t.renderList()),layer.closeAll()},no:function(){layer.closeAll()}})},selectBag:function(e){var a,t=this,o=e.name,n=e.parentNode,r=t.packageInfo.package[t.off.package].selPackage[o];a=2==r.init?["关闭"]:"active"==n.className?["不选择","关闭"]:["选择","关闭"],layer.open({content:'<div class="select-info"><dl><dt>套餐名称</dt><dd class="b">'+r.title+"</dd></dl><dl><dt>资费标准</dt><dd>"+r.standard+"</dd></dl><dl><dt>资费说明</dt><dd>"+r.feeDescribe+"</dd></dl></div>",btn:a,type:1,style:"width:90%;max-width:540px;top:-30px;",yes:function(){2!=r.init&&("active"==n.className?n.className="":n.className="active"),layer.closeAll()},no:function(){layer.closeAll()}})},selectPre:function(e){var a=this;a.off.pre=e.name,a.siblingC(e),a.mathDeduction()},makeSure:function(){var e=this;if("0000000000"==e.packageInfo.number)return!1;var a=e.getUrlParam("sysOrderId"),t=e.filterPreData(),o={params:{sysOrderId:a,prestoreMoney:e.packageInfo.package[e.off.package].prestoreMoneyList[e.off.pre].prestoreMoney,packageCode:e.packageInfo.package[e.off.package].code,selPackageCode:t,deductionType:e.off.deductionUsed?"1":"0"},userInfo:e.userInfo};e.AJAX("../../../eas/w/searchcard/SetCradInfo",o,function(a){Jsborya.isConnected(function(t){if(1==t){var o;Jsborya.pageJump({url:"",stepCode:"1001",depiction:"上传资料",data:(o={prestoreMoney:e.packageInfo.package[e.off.package].prestoreMoneyList[e.off.pre].prestoreMoney,totalMoney:parseInt(e.packageInfo.numberValue)+parseInt(e.packageInfo.package[e.off.package].prestoreMoneyList[e.off.pre].prestoreMoney),createTime:e.packageInfo.createTime,sysOrderId:e.packageInfo.sysOrderId,cityName:e.packageInfo.cityName,phoneNumber:e.packageInfo.number,actualMoney:a.data.actualMoney,cardMoney:a.data.cardMoney},(0,c.default)(o,"prestoreMoney",a.data.prestoreMoney),(0,c.default)(o,"totalMoney",a.data.totalMoney),(0,c.default)(o,"giveMoney",a.data.giveMoney),(0,c.default)(o,"deductMoney",a.data.deductMoney),(0,c.default)(o,"limitSimilarity",a.data.limitSimilarity),(0,c.default)(o,"orderStatusCode","1001"),(0,c.default)(o,"numberLevel",String(e.packageInfo.numberLevel)),(0,c.default)(o,"livingCheck",a.data.livingCheck),o)})}})})},filterPreData:function(){for(var e=this,a="",t=e.packageInfo.package[e.off.package].selPackage,o=document.getElementById("bagUl"),n=0;n<o.childNodes.length;n++)if(1===o.childNodes[n].nodeType&&""!=o.childNodes[n].className){o.childNodes[n].childNodes[0].name;a+=t[n].code+"|"}return a.substring(0,a.length-1)},more:function(e){var a,t,o=this,n=o.getUrlParam("sysOrderId");window.localStorage.setItem("KM_USERINFO",(0,r.default)(o.userInfo)),window.localStorage.setItem("KM_ORDERINFO",(0,r.default)({createTime:o.packageInfo.createTime,sysOrderId:o.packageInfo.sysOrderId,cityName:o.packageInfo.cityName,phoneNumber:o.packageInfo.number})),a=1==e?"":o.packageInfo.package[o.off.package].code,t=o.packageInfo.package[o.off.package].prestoreMoneyList[o.off.pre].prestoreMoney,Jsborya.pageJump({url:"packageDetails.html?type="+e+"&packageCode="+a+"&prestoreMoney="+t+"&sysOrderId="+n,stepCode:"1000",depiction:1==e?"更多套餐":"更多可选包",data:{createTime:o.packageInfo.createTime,sysOrderId:o.packageInfo.sysOrderId,cityName:o.packageInfo.cityName,phoneNumber:o.packageInfo.number}})},getList:function(e,a){var t=this,o={params:e,userInfo:t.userInfo};t.AJAX("../../../eas/w/searchcard/getCradInfo",o,function(e){t.packageInfo=e.data;for(var a=0;a<e.data.package.length&&1!=e.data.package[a].init;a++);t.off.package=a,t.renderList()},a)},renderList:function(){for(var e=this,a="",t=document.getElementById("bagUl"),o=document.getElementById("preUl"),n=e.packageInfo.package[e.off.package],r=(2!=e.packageInfo.discountType,0),d=n.selPackage;r<d.length;r++)a+=1==d[r].init?'<li class="active">':2==d[r].init?'<li class="active active2">':"<li>",a+='<a onclick="app.selectBag(this)" name="'+r+'" href="javascript:void(0)">'+d[r].title+"</a></li>";1==n.selPackageMore&&(a+='<li><a href="javascript:void(0)" onclick="app.more(2)">查看更多</a></li>'),t.innerHTML=a,a="";for(var c=0,i=n.prestoreMoneyList;c<i.length;c++){var s=parseInt(i[c].prestoreMoney)/100;1==i[c].init?(a+='<li class="active">',e.off.pre=c):a+="<li>",a+='<a onclick="app.selectPre(this)" name="'+c+'" href="javascript:void(0)">'+s+"元</a></li>"}o.innerHTML=a,a="",0==e.packageInfo.deductionFee?e.off.deductionUsed=!1:e.off.deductionUsed=!0,e.mathDeduction()},mathDeduction:function(e){var a,t,o,n,t,r=this,d=parseFloat(r.packageInfo.numberValue)/100;2!=r.packageInfo.discountType;a=parseFloat(r.packageInfo.package[r.off.package].prestoreMoneyList[r.off.pre].prestoreMoney)/100,t=(d+a).toFixed(2),d=d.toFixed(2),a=a.toFixed(2),e&&(r.off.deductionUsed?r.off.deductionUsed=!1:r.off.deductionUsed=!0),r.off.deductionUsed?(o=r.packageInfo.deductionFee>100*a?a:0<r.packageInfo.deductionFee<=100*a?(parseFloat(r.packageInfo.deductionFee)/100).toFixed(2):"0.00",n=(t-o).toFixed(2)):(o="0.00",n=t),r.prestoreMoney=a,r.numberValue=d,r.totalMoney=t,r.deductionMoney=o,r.payMoney=n},siblingC:function(e){for(var a=e.parentNode.parentNode,t=0;t<a.childNodes.length;t++)1===a.childNodes[t].nodeType&&(a.childNodes[t].className="");e.parentNode.className="active"}}})})},20:function(e,a,t){e.exports={default:t(22),__esModule:!0}},21:function(e,a,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}a.__esModule=!0;var n=t(20),r=o(n);a.default=function(e,a,t){return a in e?(0,r.default)(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}},22:function(e,a,t){t(35);var o=t(2).Object;e.exports=function(e,a,t){return o.defineProperty(e,a,t)}},35:function(e,a,t){var o=t(12);o(o.S+o.F*!t(4),"Object",{defineProperty:t(6).f})},39:function(e,a){}});